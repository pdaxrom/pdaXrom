#!/bin/sh
#
# X11 ROM apm wrapper
# http://www.pdaXrom.org
#

pre_suspend() {
    grep 'Sharp-Collie' /proc/cpuinfo && hwclock --systohc
    cardctl eject
    sleep 1
}

post_suspend() {
    grep 'Sharp-Collie' /proc/cpuinfo && hwclock --hctosys
    cardctl insert
    sleep 1
}

APM=/usr/bin/apm.x

if [ "$1" = "--suspend" -o "$1" = "-s" -o "$1" = "--su" ]; then
    pre_suspend
    $APM --suspend
    post_suspend
else
    $APM $@
fi
